# CryptoInvestment - Copilot Instructions

## 📋 Proyecto Overview
CryptoInvestment es una aplicación fullstack para visualizar el rendimiento de criptomonedas con precios en tiempo real y análisis histórico.

## 🛠 Stack Tecnológico

### Backend
- **Runtime**: Node.js 22+
- **Lenguaje**: TypeScript con configuración ESM
- **Framework**: Express.js
- **Base de datos**: MySQL con Drizzle ORM
- **Herramientas de desarrollo**: tsx (NO nodemon)
- **Validación**: Zod
- **API externa**: CoinMarketCap API

### Frontend  
- **Framework**: React.js con Vite
- **Tipo**: SPA (Single Page Application)
- **Gráficos**: Lightweight Charts (TradingView)

## 🔧 Configuración de Desarrollo

### TypeScript & Módulos ES
- Proyecto configurado con `"type": "module"` en package.json
- Usar `tsx` para desarrollo (NO ts-node ni nodemon)
- Comando de desarrollo: `tsx watch src/server.ts`
- **IMPORTANTE**: Las importaciones de archivos TypeScript se pueden hacer SIN extensiones
  ```typescript
  // ✅ Correcto - tsx maneja esto automáticamente
  import { config } from './config/config';
  import { logging } from './config/logging';
  
  // ❌ NO necesario agregar .js o .ts
  import { config } from './config/config.js';
  ```

### Estructura de Carpetas
```
backend/
├── src/
│   ├── config/          # Configuración y logging
│   ├── controllers/     # Controladores de API
│   ├── middleware/      # Middleware de Express
│   ├── routes/         # Definición de rutas
│   ├── services/       # Servicios externos (CoinMarketCap)
│   ├── db/             # Schema y configuración DB
│   └── server.ts       # Punto de entrada
├── package.json        # Configurado con type: "module"
├── tsconfig.json       # Configuración TypeScript ESM
└── drizzle.config.ts   # Configuración Drizzle ORM
```

## 📝 Guidelines de Código

### Importaciones
- Usar importaciones ES modules nativas
- No agregar extensiones (.js/.ts) a archivos TypeScript
- Usar `import type` para tipos cuando `verbatimModuleSyntax` esté habilitado
- Ejemplo:
  ```typescript
  import express from 'express';
  import type { Request, Response } from 'express';
  import { db } from './db/connection';
  ```

### Base de datos
- Usar Drizzle ORM para todas las operaciones de DB
- Schema definido en `src/db/schema.ts`
- Validación con Zod schemas
- Ejemplo:
  ```typescript
  import { eq } from 'drizzle-orm';
  import { db } from '../db/connection';
  import { cryptocurrencies } from '../db/schema';
  
  const crypto = await db.select().from(cryptocurrencies).where(eq(cryptocurrencies.id, 1));
  ```

### API Structure
- RESTful endpoints bajo `/api/v1/`
- Usar controladores separados
- Middleware para CORS, logging, error handling
- Respuestas consistentes:
  ```typescript
  {
    success: boolean,
    data?: any,
    message?: string,
    error?: string
  }
  ```

### Scripts de Development
```json
{
  "scripts": {
    "dev": "tsx watch src/server.ts",
    "build": "tsc",
    "start": "node dist/server.js",
    "db:generate": "drizzle-kit generate",
    "db:push": "drizzle-kit push"
  }
}
```

## 🚨 Reglas Importantes

1. **NO usar nodemon** - tsx tiene watch mode integrado
2. **NO agregar .js a imports TypeScript** - tsx los resuelve automáticamente  
3. **Usar Drizzle ORM** para DB, no SQL crudo
4. **Validar con Zod** antes de procesar datos
5. **Mantener configuración ESM** (`"type": "module"`)
6. **Usar logging personalizado** del proyecto en lugar de console.log

## 🔑 Variables de Entorno
```env
NODE_ENV=development
PORT=3001
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=your_password
DB_NAME=cryptoinvestment
COINMARKETCAP_API_KEY=your_api_key
FRONTEND_URL=http://localhost:5173
```

## 🎯 Al generar código, siempre:
- Usar la configuración tsx existente
- Mantener imports sin extensiones para archivos TS
- Seguir la estructura de carpetas establecida
- Usar Drizzle ORM para operaciones de DB
- Implementar validación con Zod
- Incluir manejo de errores apropiado
- Usar el sistema de logging personalizado
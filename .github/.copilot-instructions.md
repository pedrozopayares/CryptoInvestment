# CryptoInvestment - Copilot Instructions

## ğŸ“‹ Proyecto Overview
CryptoInvestment es una aplicaciÃ³n fullstack para visualizar el rendimiento de criptomonedas con precios en tiempo real y anÃ¡lisis histÃ³rico.

## ğŸ›  Stack TecnolÃ³gico

### Backend
- **Runtime**: Node.js 22+
- **Lenguaje**: TypeScript con configuraciÃ³n ESM
- **Framework**: Express.js
- **Base de datos**: MySQL con Drizzle ORM
- **Herramientas de desarrollo**: tsx (NO nodemon)
- **ValidaciÃ³n**: Zod
- **API externa**: CoinMarketCap API

### Frontend  
- **Framework**: React.js con Vite
- **Tipo**: SPA (Single Page Application)
- **GrÃ¡ficos**: Lightweight Charts (TradingView)

## ğŸ”§ ConfiguraciÃ³n de Desarrollo

### TypeScript & MÃ³dulos ES
- Proyecto configurado con `"type": "module"` en package.json
- Usar `tsx` para desarrollo (NO ts-node ni nodemon)
- Comando de desarrollo: `tsx watch src/server.ts`
- **IMPORTANTE**: Las importaciones de archivos TypeScript se pueden hacer SIN extensiones
  ```typescript
  // âœ… Correcto - tsx maneja esto automÃ¡ticamente
  import { config } from './config/config';
  import { logging } from './config/logging';
  
  // âŒ NO necesario agregar .js o .ts
  import { config } from './config/config.js';
  ```

### Estructura de Carpetas
```
backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ config/          # ConfiguraciÃ³n y logging
â”‚   â”œâ”€â”€ controllers/     # Controladores de API
â”‚   â”œâ”€â”€ middleware/      # Middleware de Express
â”‚   â”œâ”€â”€ routes/         # DefiniciÃ³n de rutas
â”‚   â”œâ”€â”€ services/       # Servicios externos (CoinMarketCap)
â”‚   â”œâ”€â”€ db/             # Schema y configuraciÃ³n DB
â”‚   â””â”€â”€ server.ts       # Punto de entrada
â”œâ”€â”€ package.json        # Configurado con type: "module"
â”œâ”€â”€ tsconfig.json       # ConfiguraciÃ³n TypeScript ESM
â””â”€â”€ drizzle.config.ts   # ConfiguraciÃ³n Drizzle ORM
```

## ğŸ“ Guidelines de CÃ³digo

### Importaciones
- Usar importaciones ES modules nativas
- No agregar extensiones (.js/.ts) a archivos TypeScript
- Usar `import type` para tipos cuando `verbatimModuleSyntax` estÃ© habilitado
- Ejemplo:
  ```typescript
  import express from 'express';
  import type { Request, Response } from 'express';
  import { db } from './db/connection';
  ```

### Base de datos
- Usar Drizzle ORM para todas las operaciones de DB
- Schema definido en `src/db/schema.ts`
- ValidaciÃ³n con Zod schemas
- Ejemplo:
  ```typescript
  import { eq } from 'drizzle-orm';
  import { db } from '../db/connection';
  import { cryptocurrencies } from '../db/schema';
  
  const crypto = await db.select().from(cryptocurrencies).where(eq(cryptocurrencies.id, 1));
  ```

### API Structure
- RESTful endpoints bajo `/api/v1/`
- Usar controladores separados
- Middleware para CORS, logging, error handling
- Respuestas consistentes:
  ```typescript
  {
    success: boolean,
    data?: any,
    message?: string,
    error?: string
  }
  ```

### Scripts de Development
```json
{
  "scripts": {
    "dev": "tsx watch src/server.ts",
    "build": "tsc",
    "start": "node dist/server.js",
    "db:generate": "drizzle-kit generate",
    "db:push": "drizzle-kit push"
  }
}
```

## ğŸš¨ Reglas Importantes

1. **NO usar nodemon** - tsx tiene watch mode integrado
2. **NO agregar .js a imports TypeScript** - tsx los resuelve automÃ¡ticamente  
3. **Usar Drizzle ORM** para DB, no SQL crudo
4. **Validar con Zod** antes de procesar datos
5. **Mantener configuraciÃ³n ESM** (`"type": "module"`)
6. **Usar logging personalizado** del proyecto en lugar de console.log

## ğŸ”‘ Variables de Entorno
```env
NODE_ENV=development
PORT=3001
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=your_password
DB_NAME=cryptoinvestment
COINMARKETCAP_API_KEY=your_api_key
FRONTEND_URL=http://localhost:5173
```

## ğŸ¯ Al generar cÃ³digo, siempre:
- Usar la configuraciÃ³n tsx existente
- Mantener imports sin extensiones para archivos TS
- Seguir la estructura de carpetas establecida
- Usar Drizzle ORM para operaciones de DB
- Implementar validaciÃ³n con Zod
- Incluir manejo de errores apropiado
- Usar el sistema de logging personalizado